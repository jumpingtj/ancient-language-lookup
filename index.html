<!DOCTYPE html>
<html>
  <body>
    <input type="text" id="inp">
    <div id="out"></div>
    <script type="module">
        var table = "not defined";
        var inpElm = document.getElementById("inp")
        var outElm = document.getElementById("out")
      function main() {
        var v = inpElm.value;
        console.log(v);
          if (v === null) {
            return;
          }
          var ress = [];
          for (var i = 0; i < table.length; i++) {
            var exp = new RegExp("(?:^|,| )" + v + "(?:$|,| )", "i");
            if (table[i][0].match(exp) || table[i][1].match(exp)) {
              ress.push(table[i][0] + ": " + table[i][1]);
            }
          }
          ress = ress.sort(function(a, b) {
            return a.length - b.length || // sort by length, if equal then
                   a.localeCompare(b);    // sort by dictionary order
          });
          var res = "";
          for (var i=0;i<ress.length;i++) {
            console.log(ress[i]);
            res += ress[i] + "<br>";
            if (!i) {
                res += "<br>"
            }
          }
          console.log(res);
          outElm.innerHTML = res;
      }
      fetch("/table.json")
        .then((res) => res.json())
        .then((out) => {
        table = out;
        })
        .catch((err) => {
          throw err;
        });
        document.addEventListener("keypress", (ev) => {
            if (ev.keyCode === 32 && table !== "not defined") {
                main();
            }
        });
    </script>
  </body>
</html>
